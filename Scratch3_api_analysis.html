<!--

 -----------------
< 终于等到你 >
 -----------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||
----------------------------------

我正在构建一个基于网络协作的虚拟团队
喜欢你这种没事瞎翻源码的人
如果你恰好也热爱技术、喜欢折腾，一起来捣鼓好玩的东西吧
联系我咯: wuwenjie718@gmail.com
-->
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>Scratch3.0技术分析之后端API(第0篇)</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="writing for time">
    <meta name="author" content="wwj">

    <!-- Le styles -->
    <link href="//cdn.bootcss.com/twitter-bootstrap/2.0.4/css/bootstrap.min.css" rel="stylesheet">
    <link rel="icon" href="//7kttuq.com1.z0.glb.clouddn.com/just4fun.png?imageView2/2/w/50" type="image/x-icon">
    <style type="text/css">
      body {
        padding-top: 60px;
        padding-bottom: 40px;
      }
      .sidebar-nav {
        padding: 9px 0;
      }
	
	.tag-1 {
		font-size: 13pt;
	}
	
	.tag-2 {
		font-size: 10pt;
	}
	
	.tag-2 {
		font-size: 8pt;
	}

	.tag-4 {
		font-size: 6pt;
	}

  #footer img{
    visibility: hidden;
  }
	
    </style>
    <link href="//cdn.bootcss.com/twitter-bootstrap/2.0.4/css/bootstrap-responsive.min.css" rel="stylesheet">
    <link href="//cdn.bootcss.com/font-awesome/3.0.0/css/font-awesome.min.css" rel="stylesheet">
	
    <link href="/theme/css/pygments.css" rel="stylesheet">
	<link href="/theme/css/mystyle.css" rel="stylesheet">
    <!-- Le HTML5 shim, for IE6-8 support of HTML5 elements -->
    <!--[if lt IE 9]>
      <script src="//html5shim.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link rel="shortcut icon" href="http://wwj-tmp-video.just4fun.site/favicon.ico">
    <!-- Le fav and touch icons -->


  </head>

  <body>

    <div class="navbar navbar-fixed-top">
      <div class="navbar-inner">
        <div class="container-fluid">
          <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </a>
          <a class="brand" href="/index.html">writing for time </a>
          <div class="nav-collapse">
            <ul class="nav">
			  <li class="divider-vertical"></li>
                  <li >
                    <a href="/category/编程.html">
						<i class="icon-folder-open icon-large"></i>编程
					</a>
                  </li>
                  <li >
                    <a href="/category/读书.html">
						<i class="icon-folder-open icon-large"></i>读书
					</a>
                  </li>
                  <li >
                    <a href="/category/edx.html">
						<i class="icon-folder-open icon-large"></i>edx
					</a>
                  </li>
                  <li >
                    <a href="/category/工具.html">
						<i class="icon-folder-open icon-large"></i>工具
					</a>
                  </li>
                  <li >
                    <a href="/category/观念.html">
						<i class="icon-folder-open icon-large"></i>观念
					</a>
                  </li>
                  <li >
                    <a href="/category/技术.html">
						<i class="icon-folder-open icon-large"></i>技术
					</a>
                  </li>
                  <li >
                    <a href="/category/架构.html">
						<i class="icon-folder-open icon-large"></i>架构
					</a>
                  </li>
                  <li >
                    <a href="/category/空想.html">
						<i class="icon-folder-open icon-large"></i>空想
					</a>
                  </li>
                  <li class="active">
                    <a href="/category/少儿编程.html">
						<i class="icon-folder-open icon-large"></i>少儿编程
					</a>
                  </li>
                  <li >
                    <a href="/category/诗词.html">
						<i class="icon-folder-open icon-large"></i>诗词
					</a>
                  </li>
                  <li >
                    <a href="/category/数据.html">
						<i class="icon-folder-open icon-large"></i>数据
					</a>
                  </li>
                  <li >
                    <a href="/category/算法.html">
						<i class="icon-folder-open icon-large"></i>算法
					</a>
                  </li>
                  <li >
                    <a href="/category/随笔.html">
						<i class="icon-folder-open icon-large"></i>随笔
					</a>
                  </li>
                  <li >
                    <a href="/category/瓦碎集.html">
						<i class="icon-folder-open icon-large"></i>瓦碎集
					</a>
                  </li>
                  <li >
                    <a href="/category/硬件.html">
						<i class="icon-folder-open icon-large"></i>硬件
					</a>
                  </li>
			  
			  <ul class="nav pull-right">
				<li><a href="/archives.html"><i class="icon-th-list"></i>Archives</a></li>
			  </ul>
			  
            </ul>
            <!--<p class="navbar-text pull-right">Logged in as <a href="#">username</a></p>-->
          </div><!--/.nav-collapse -->
        </div>
      </div>
    </div>





    <div class="container-fluid">
      <div class="row">

        <div class="span8 offset1" id="content">
            <!--<div class="alert alert-success" style="font-size:18px;">>  你那里天气好吗，有什么新闻可以当做笑话</div>-->
<section id="content">    
	<article>
		<header>
			<h1>
				<a href=""
					rel="bookmark" 
					title="Permalink to Scratch3.0技术分析之后端API(第0篇)">
					Scratch3.0技术分析之后端API(第0篇) 
				</a>
			</h1> 
		</header>
		<div class="entry-content">
		<div class="well">
<footer class="post-info">
<span class="label">Date</span>
<abbr class="published" title="2019-01-06T00:00:00+00:00">
	<i class="icon-calendar"></i>日 06 一月 2019
</abbr>
<span class="label">By</span>
<a href="/author/wuwenjie.html"><i class="icon-user"></i>wuwenjie</a>
<span class="label">Category</span>
<a href="/category/shao-er-bian-cheng.html"><i class="icon-folder-open"></i>少儿编程</a>. 

	
<span class="label">Tags</span> 
	<a href="/tag/scratch.html"><i class="icon-tag"></i>scratch</a>
</footer><!-- /.post-info -->		</div>
		<p><img alt="" src="http://wwj-fig-bed.just4fun.site/scratch_analyse_6179c869.png" /></p>
<p>近期我们计划对Scratch3.0做一系列的技术分析，这是这个系列的开篇。</p>
<p>我们致力于实现以下目标：</p>
<ul>
<li>理解Scratch3.0的架构设计</li>
<li>理解Scratch拥有强大兼容性的原因</li>
<li>梳理Scratch3.0产品背后使用的一些设计原则<ul>
<li>表现与实现的分离</li>
<li>事件驱动</li>
<li>面相对象</li>
<li>everything is message</li>
</ul>
</li>
<li>按照Scratch一贯的设计原则，独立实现Scratch并未开源的部分。确保之后能随着Scratch一同升级，架构上保证向后兼容。</li>
<li>顺着Scratch的思路，对Scratch作出改进。</li>
</ul>
<p>总而言之，我们希望通过这些分析，获得定制scratch的能力，但同时又能与上游的官方版本保持兼容。我们重视官方对Scratch的改进。与其说我们重视他们技术能力，不如说我们重视他们对教育和社区的深刻理解，这些是极为稀缺的，它不是技术问题，也不是资金问题。我们希望能随时将官方的改进merge回我们调整后的项目中。我们不希望做出硬分叉。</p>
<h1 id="scratch30">Scratch3.0 正式发布</h1>
<p>Scratch3.0于2019.1.2如期而至。 </p>
<p>Scratch3.0的<a href="https://github.com/LLK/scratch-gui">GUI</a>和<a href="https://github.com/LLK/scratch-www">社区的前端</a>都已开源:<a href="https://github.com/LLK">LLK</a>。</p>
<p>你可以<a href="https://scratch.mit.edu/">在线体验</a>一番.</p>
<p>目前Scratch3.0团队没有透露社区后端和GUI的存储部分是否有开源计划(我们之后将这两块统称为后端)，我此前和Scratch3.0后端团队成员做过沟通，他提到Scratch3.0后端目前同时采用了新构建的REST API和之前遗留的Django server。他们陆续将一些基础服务从Django中迁出，转化为API对外提供服务。从我们之后的分析中可以知道，他们新的后端基于<a href="http://restify.com/">restify</a>。我想官方的技术选型主要出于<a href="http://restify.com/">restify</a>对REST的友好支持，以及<a href="http://restify.com/">restify</a>应对高负载的能力，毕竟Scratch社区有3000万用户。</p>
<p>考虑到Scratch2.0的后端并未开源，3.0社区后端开源的概率估计也不大。个中原因可能是防止社区分裂。毕竟每家公司跑一个scratch社区挺奇怪的，它分裂了用户群。更何况，大多数的公司采取的教育策略，正是《终生幼儿园》所反对的。</p>
<p>除了Scratch3.0的社区后端，Scratch3.0的其他部分，官方都有计划开源，包括desktop，终生幼儿园小组正在和MIT校方沟通推进这件事，这些信息在scratch团队日常的讨论中有提到。</p>
<h1 id="_1">为何做这个分析</h1>
<p>Scratch3.0的社区与插件系统，将开放到什么程度？官方的计划是什么？目前scratch团队并没有给出明确说明.他们在FAQ中提到说这部分的工作还在进展中。</p>
<p>我们(codelab.club)今年(2019)上半年有计划与scratch team碰个面，如果官方接受，我们希望将<a href="https://codelab-adapter-docs.codelab.club/">codelab-adapter</a>集成到官方项目中。帮助Scratch3.0连接到更广阔的世界(education as life)，同时建立Scratch3.0与Python(或者任何其他语言)的无缝连接。如果官方没太大合作意愿，也不愿开放接入机制，我们将独立构建用户社区。我们仍鼓励用户使用scratch官方社区（如果网络顺畅），因为那里边有丰富而友好的的人群，海量的不可思议的创意项目，以及scratch团队令人称赞的运营方式。但对于那些官方不支持的创造，尤其是与生活相关的创造(education as life),我们将提供另一个社区来支持用户。我们的目标是让万物积木化，支持更广泛的创造。支持杜威提倡的</p>
<blockquote>
<p>education as life</p>
</blockquote>
<p>我们关注如何构建出兼容官方已有开放项目的后端，让用户保持一致的使用体验。同时也保证我们随时可以merge回官方的最新进展。我们另有一个野心是在我们的实现中加入<a href="https://www.w3.org/TR/activitypub/">activitypub</a>，让scratch的社区数据，轻松支持跨站共享和分布式存储。 codelab.club是一个非营利组织，这是我们希望支持落后地区的一个举措。让我们设想一种场景，在贫困山区，网络并不通畅，如何帮助那儿的孩子接入到社区中？他们如何了解社区最近创造出的有趣的项目(projects)？而peers和projects是scratch很核心的2个概念。有了<a href="https://www.w3.org/TR/activitypub/">activitypub</a>，我们在山区中可以使用树莓派跑一个scratch社区后端，孩子们可以在局域网内形成社区（一台树莓派即可，树莓派可以发射热点构建局域网）。当志愿者到来，开放出手机热点，<a href="https://www.w3.org/TR/activitypub/">activitypub</a>将为他们把外部世界的数据同步进来。很多的手机卡已经几乎免流量了。这件事没有想象的那么困难，即便在经济上也没有。</p>
<p><a href="https://www.w3.org/TR/activitypub/">activitypub</a>可能起作用的场景当然远不止贫困山区。关于这块的可能性有空在谈。</p>
<p>为了支持我们上边提到的所有目标。我们需要分析目前官方的后端API（其他开源的部分我们也将分析）。我们看到scratch为兼容性这块付出了巨大的努力，他们精心设计了数据的结构，他们花了很大精力来保持对旧版本的兼容，他们甚至希望兼容到1.4版本(十年前的项目！). Scratch团队始终不抛弃已有的用户和用户创作的项目，很难看到比scratch team更尊重用户作品的组织了，这是一群令人肃然起敬的教育者。</p>
<h1 id="scratch-api">整理已有的Scratch API相关文档</h1>
<p>社区里目前有不少Scratch后端API相关的文档和项目。</p>
<p>在此做个梳理。</p>
<ul>
<li><a href="https://en.scratch-wiki.info/wiki/Scratch_API_(2.0)">Scratch API（2.0）</a></li>
<li><a href="https://en.scratch-wiki.info/wiki/Scratch_APIs">Scratch APIs</a></li>
<li><a href="https://github.com/LLK/scratch-rest-api/wiki">LLK/scratch-rest-api/wiki</a></li>
<li><a href="https://github.com/towerofnix/scratch-api-unofficial-docs">towerofnix/scratch-api-unofficial-docs</a></li>
<li><a href="https://github.com/trumank/scratch-api">trumank/scratch-api</a></li>
<li><a href="https://github.com/PolyEdge/scratchapi">PolyEdge/scratchapi</a></li>
</ul>
<p>这些项目是Scratch2.0的API，但Scratch3.0和2.0的API基本是相同的。主要原因我们前边有提到: 出于兼容性的考虑。</p>
<p>我在完成这篇文章的途中，也会顺手给出scratch3.0的api文档，如果时间允许，我还将给出Python实现的Scratch client。</p>
<p>此外，也可能顺手实现Python版本的<a href="https://github.com/LLK/scratch-parser">scratch-parser</a>，这个工具将来会成为我们为scratch用户制作画像的基础，由于Python社区的数据分析生态最成熟，所以我计划用Python来做。评估Scratch用户的学习效果，以及用户对知识的掌握情况，我认为目前是项目驱动的平台（如scratch）存在的痛点。我们希望这个项目支持所有Scratch平台，只要大家兼容官方的数据结构即可。这就是我们如此重视兼容性的原因，因为这样有助于打造通用的工具链。</p>
<p>评估学习者的学习进展并不容易，我认为对程序的静态分析可能是突破口之一，所以我们需要重新实现<a href="https://github.com/LLK/scratch-parser">scratch-parser</a>。在静态分析的基础上，加上一些机器学习的算法和推荐系统，将来甚至可以做到，针对用户的学习情况和兴趣点，给他推荐可能感兴趣的人与项目。如此一来，线上平台就部分实现了我们希望在club中实现的东西：帮助用户去寻找和发现感兴趣的projects与peers。</p>
<h1 id="_2">工作计划</h1>
<p>我们的分析工作从<a href="https://scratch.mit.edu/projects/editor/">创作平台</a>开始。</p>
<p>之后转向分析<a href="https://scratch.mit.edu/">社区</a>。</p>
<p>我们相信这一系列的文章对于准备使用Scratch3.0作为公司基础项目的产品经理和系统架构师会有价值。</p>
<h1 id="_3">文章列表</h1>
<p>截止到2019.01.15这个系列的分析文章基本写完了,整理如下:</p>
<ul>
<li><a href="https://blog.just4fun.site/Scratch3_api_analysis.html">Scratch3.0技术分析之后端API(第0篇)</a></li>
<li><a href="https://blog.just4fun.site/Scratch3_api_analysis_1.html">Scratch3技术分析之创作平台API(第1篇)</a></li>
<li><a href="https://blog.just4fun.site/Scratch3_asset_analysis_2.html">Scratch3技术分析之静态资源API(第2篇)</a></li>
<li><a href="https://blog.just4fun.site/Scratch3_project_homepage_analysis_3.html">Scratch3技术分析之项目主页API(第3篇)</a></li>
<li><a href="https://blog.just4fun.site/Scratch3_user_api_analysis_4.html">Scratch3技术分析之User API(第4篇)
</a></li>
<li><a href="https://blog.just4fun.site/Scratch3_community_analysis_5.html">Scratch3技术分析之社区 API(第5篇)</a></li>
<li><a href="https://blog.just4fun.site/Scratch3_project_json_analysis_6.html">Scratch3技术分析之项目内部数据(第6篇）</a></li>
</ul>
<!--
Project
    创作平台API
        Project model/json
    静态资源API
        创作平台
        其他的API   
        缓存问题/过期
    项目主页API
        点赞/评论
Studio

User

之后是关系(软的)

补遗
    用户程序的数据的表示(json)。
-->
		</div><!-- /.entry-content -->
<!--
<p style="font-size:16px" class="alert alert-info">此文对我有价值，打赏杯茶喝^_^  <a target="_blank" class="btn btn-primary btn-large" href="https://me.alipay.com/wuwj">支付宝打赏</a> </p>
-->
<hr>
<div class="alert alert-success">版权声明：<a href="http://creativecommons.org/licenses/by-nc-nd/3.0/deed.zh">自由转载-非商用-非衍生-保持署名</a></div>
<hr>
<!-- Duoshuo Comment BEGIN -->
<!--
	<div class="ds-thread"></div>
<script type="text/javascript">
var duoshuoQuery = {short_name:"wwj718blog"};
	(function() {
		var ds = document.createElement('script');
		ds.type = 'text/javascript';ds.async = true;
		ds.src = 'http://static.duoshuo.com/embed.js';
		ds.charset = 'UTF-8';
		(document.getElementsByTagName('head')[0] 
		|| document.getElementsByTagName('body')[0]).appendChild(ds);
	})();
	</script>
    -->
    <!-- Duoshuo Comment END -->
	</article>
</section>
        </div><!--/span-->
      
		<div style="margin-left:70px;" class="span3 well sidebar-nav" id="sidebar">
<ul class="nav nav-list">
    <!--<a href="/others/startedx.html"><h3>Open edX相关咨询</h3></a>-->
<hr/>
<!--
<h3>我的服务<h3>
    <a href="http://olk8jbdzi.bkt.clouddn.com/index.html"><h4>开源在线表单设计工具</h4></a>
    <a href="#kinto.jsut4fun.site"><h4>kinto server(施工中)</h4></a>
    <a href="#"><h4></h4></a>
-->
<!--<a href="/join-us"><h3>招兵买马(招实习!)<h3></a>-->
</hr>
</hr>

<li style="text-align: center;"><a target="_blank"  href="https://www.e-ducation.cn/?utm_source=zgblog&utm_medium=ads&utm_campaign=marketing_01"><img src="http://wwj-tmp-video.just4fun.site/education.png" width="100%" max-width="250px" /> </a></li>
<hr/>

<h4>我近期在折腾</h4>
<li><a href="https://blog.just4fun.site/about-codelab-club.html" target="_blank">codelab.club</a></li>
<li><a href="https://codelab-adapter-docs.codelab.club/" target="_blank">codelab-adapter</a></li>
<li><a href="https://forums.codelab.club/" target="_blank">forums.codelab.club</a></li>
<hr/>

<h4>少儿编程指北</h4>
<p>关注少儿编程，回顾这个领域的发展历程，推荐、解读经典书籍和文章，吐槽糟糕的教育，也推荐一些好产品和有趣的项目。不蹭热点不站队 :）</p>
<li style="text-align: center;">
<img src="http://scratch3-files.just4fun.site/qrcode_for_gh_e458d8658f3b_258.jpg" width="150px" /> 
</li>
<hr/>

<h4>站内搜索(基于google，你可能看不到)</h4>
<div>
<script>
  (function() {
       var cx = '004056624884628766270:aaifcpik-ua';
	       var gcse = document.createElement('script');
		       gcse.type = 'text/javascript';
			       gcse.async = true;
				       gcse.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') +
					           '//www.google.com/cse/cse.js?cx=' + cx;
							       var s = document.getElementsByTagName('script')[0];
								       s.parentNode.insertBefore(gcse, s);
									     })();
</script>
<gcse:search></gcse:search>
</div>
<hr>
<h4>手机访问：</h4>
<li style="text-align: center;">
<img src="http://wwj-tmp-video.just4fun.site/1514204585.png" width="150px" /> 
</li>

    <li><i class="icon-external-link"></i><a href="/aboutme.html">关于我</a></li>
    <li><i class="icon-external-link"></i><a href="https://github.com/wwj718">my github</a></li>
    <li><i class="icon-external-link"></i><a href="#">my gmail：wuwenjie718@gmail.com</a></li>
<hr>

<li class="nav-header"><h4><i class="icon-folder-close icon-large"></i>分类</h4></li>
<li>
<a href="/category/编程.html">
    <i class="icon-folder-open icon-large"></i>编程
</a>
</li>
<li>
<a href="/category/读书.html">
    <i class="icon-folder-open icon-large"></i>读书
</a>
</li>
<li>
<a href="/category/edx.html">
    <i class="icon-folder-open icon-large"></i>edx
</a>
</li>
<li>
<a href="/category/工具.html">
    <i class="icon-folder-open icon-large"></i>工具
</a>
</li>
<li>
<a href="/category/观念.html">
    <i class="icon-folder-open icon-large"></i>观念
</a>
</li>
<li>
<a href="/category/技术.html">
    <i class="icon-folder-open icon-large"></i>技术
</a>
</li>
<li>
<a href="/category/架构.html">
    <i class="icon-folder-open icon-large"></i>架构
</a>
</li>
<li>
<a href="/category/空想.html">
    <i class="icon-folder-open icon-large"></i>空想
</a>
</li>
<li>
<a href="/category/少儿编程.html">
    <i class="icon-folder-open icon-large"></i>少儿编程
</a>
</li>
<li>
<a href="/category/诗词.html">
    <i class="icon-folder-open icon-large"></i>诗词
</a>
</li>
<li>
<a href="/category/数据.html">
    <i class="icon-folder-open icon-large"></i>数据
</a>
</li>
<li>
<a href="/category/算法.html">
    <i class="icon-folder-open icon-large"></i>算法
</a>
</li>
<li>
<a href="/category/随笔.html">
    <i class="icon-folder-open icon-large"></i>随笔
</a>
</li>
<li>
<a href="/category/瓦碎集.html">
    <i class="icon-folder-open icon-large"></i>瓦碎集
</a>
</li>
<li>
<a href="/category/硬件.html">
    <i class="icon-folder-open icon-large"></i>硬件
</a>
</li>

<li class="nav-header"><h4><i class="icon-tags icon-large"></i>Tags</h4></li>
<hr>

<a target="_blank" href="http://wwj718.github.io/feeds/all.rss.xml">订阅feed</a>


<hr>
<h3>友情链接</h3>
<li><a target="_blank"  href="https://scratch.mit.edu/">Scratch</a></li>
<li><a target="_blank"  href="https://www.raspberrypi.org/">Raspberry Pi</a></li>
<li><a target="_blank" href="http://microbit.org/">micro:bit</a></li>
<li><a target="_blank" href="https://code.org/">Code.org</a></li>
<li><a target="_blank" href="https://www.edustack.org/">edustack</a></li>
<li><a target="_blank" href="http://blog.e-ducation.cn/">e-ducation</a></li>

</ul>        </div><!--/.well -->

      </div><!--/row-->

      <hr>

      <footer id="footer">
        <address id="about">
            诗酒趁年华<hr>
              powered by Pelican 
              <hr>
              <a href="www.miitbeian.gov.cn" target="_blank">苏ICP备18043473号</a>
<script type="text/javascript">
var _bdhmProtocol = (("https:" == document.location.protocol) ? " https://" : " http://");
document.write(unescape("%3Cscript src='" + _bdhmProtocol + "hm.baidu.com/h.js%3F18db4b662c04fbd6cc2851d246c51b3f' type='text/javascript'%3E%3C/script%3E"));
</script>        </address><!-- /#about -->
      </footer>

    </div><!--/.fluid-container-->
<a href="https://github.com/wwj718"><img style="position: absolute; top: 0; left: 0; border: 0;" src="https://camo.githubusercontent.com/567c3a48d796e2fc06ea80409cc9dd82bf714434/68747470733a2f2f73332e616d617a6f6e6177732e636f6d2f6769746875622f726962626f6e732f666f726b6d655f6c6566745f6461726b626c75655f3132313632312e706e67" alt="Fork me on GitHub" data-canonical-src="https://s3.amazonaws.com/github/ribbons/forkme_left_darkblue_121621.png"></a>

    <!-- Le javascript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script src="http://libs.baidu.com/jquery/1.8.2/jquery.min.js"></script>
    <script src="//cdn.bootcss.com/twitter-bootstrap/2.0.4/bootstrap.min.js"></script>
    <!--
    <script src="/theme/js/bootstrap-transition.js"></script>
    <script src="/theme/js/bootstrap-dropdown.js"></script>
    <script src="/theme/js/bootstrap-collapse.js"></script>
    -->
	
	<!--<script src="/theme/js/autosidebar.js"></script>-->
  </body>
</html>
