<!--

 -----------------
< 终于等到你 >
 -----------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||
----------------------------------

我正在构建一个基于网络协作的虚拟团队，
喜欢你这种没事喜欢翻源码的人
如果你恰好也热爱技术、喜欢折腾，来啊，互相伤害，一起捣鼓好玩的东西吧
联系我咯: wuwenjie718@gmail.com
-->
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>正则表达式一例</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="writing for time">
    <meta name="author" content="wwj">

    <!-- Le styles -->
    <link href="http://cdn.bootcss.com/twitter-bootstrap/2.0.4/css/bootstrap.min.css" rel="stylesheet">
    <link rel="icon" href="http://7kttuq.com1.z0.glb.clouddn.com/just4fun.png?imageView2/2/w/50" type="image/x-icon">
    <style type="text/css">
      body {
        padding-top: 60px;
        padding-bottom: 40px;
      }
      .sidebar-nav {
        padding: 9px 0;
      }
	
	.tag-1 {
		font-size: 13pt;
	}
	
	.tag-2 {
		font-size: 10pt;
	}
	
	.tag-2 {
		font-size: 8pt;
	}

	.tag-4 {
		font-size: 6pt;
	}

  #footer img{
    visibility: hidden;
  }
	
    </style>
    <link href="http://cdn.bootcss.com/twitter-bootstrap/2.0.4/css/bootstrap-responsive.min.css" rel="stylesheet">
    <link href="http://cdn.bootcss.com/font-awesome/3.0.0/css/font-awesome.min.css" rel="stylesheet">
	
    <link href="/theme/css/pygments.css" rel="stylesheet">
	<link href="/theme/css/mystyle.css" rel="stylesheet">
    <!-- Le HTML5 shim, for IE6-8 support of HTML5 elements -->
    <!--[if lt IE 9]>
      <script src="//html5shim.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Le fav and touch icons -->


  </head>

  <body>

    <div class="navbar navbar-fixed-top">
      <div class="navbar-inner">
        <div class="container-fluid">
          <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </a>
          <a class="brand" href="/index.html">writing for time </a>
          <div class="nav-collapse">
            <ul class="nav">
			  <li class="divider-vertical"></li>
                  <li >
                    <a href="/category/编程.html">
						<i class="icon-folder-open icon-large"></i>编程
					</a>
                  </li>
                  <li >
                    <a href="/category/读书.html">
						<i class="icon-folder-open icon-large"></i>读书
					</a>
                  </li>
                  <li >
                    <a href="/category/edx.html">
						<i class="icon-folder-open icon-large"></i>edx
					</a>
                  </li>
                  <li >
                    <a href="/category/工具.html">
						<i class="icon-folder-open icon-large"></i>工具
					</a>
                  </li>
                  <li >
                    <a href="/category/观念.html">
						<i class="icon-folder-open icon-large"></i>观念
					</a>
                  </li>
                  <li class="active">
                    <a href="/category/技术.html">
						<i class="icon-folder-open icon-large"></i>技术
					</a>
                  </li>
                  <li >
                    <a href="/category/架构.html">
						<i class="icon-folder-open icon-large"></i>架构
					</a>
                  </li>
                  <li >
                    <a href="/category/空想.html">
						<i class="icon-folder-open icon-large"></i>空想
					</a>
                  </li>
                  <li >
                    <a href="/category/诗词.html">
						<i class="icon-folder-open icon-large"></i>诗词
					</a>
                  </li>
                  <li >
                    <a href="/category/数据.html">
						<i class="icon-folder-open icon-large"></i>数据
					</a>
                  </li>
                  <li >
                    <a href="/category/算法.html">
						<i class="icon-folder-open icon-large"></i>算法
					</a>
                  </li>
                  <li >
                    <a href="/category/随笔.html">
						<i class="icon-folder-open icon-large"></i>随笔
					</a>
                  </li>
                  <li >
                    <a href="/category/瓦碎集.html">
						<i class="icon-folder-open icon-large"></i>瓦碎集
					</a>
                  </li>
                  <li >
                    <a href="/category/硬件.html">
						<i class="icon-folder-open icon-large"></i>硬件
					</a>
                  </li>
			  
			  <ul class="nav pull-right">
				<li><a href="/archives.html"><i class="icon-th-list"></i>Archives</a></li>
			  </ul>
			  
            </ul>
            <!--<p class="navbar-text pull-right">Logged in as <a href="#">username</a></p>-->
          </div><!--/.nav-collapse -->
        </div>
      </div>
    </div>





    <div class="container-fluid">
      <div class="row">

        <div class="span8 offset1" id="content">
            <!--<div class="alert alert-success" style="font-size:18px;">>  你那里天气好吗，有什么新闻可以当做笑话</div>-->
<section id="content">    
	<article>
		<header>
			<h1>
				<a href=""
					rel="bookmark" 
					title="Permalink to 正则表达式一例">
					正则表达式一例 
				</a>
			</h1> 
		</header>
		<div class="entry-content">
		<div class="well">
<footer class="post-info">
<span class="label">Date</span>
<abbr class="published" title="2015-05-20T00:00:00+00:00">
	<i class="icon-calendar"></i>三 20 五月 2015
</abbr>
<span class="label">By</span>
<a href="/author/wuwenjie.html"><i class="icon-user"></i>wuwenjie</a>
<span class="label">Category</span>
<a href="/category/ji-zhu.html"><i class="icon-folder-open"></i>技术</a>. 

	
<span class="label">Tags</span> 
	<a href="/tag/regex.html"><i class="icon-tag"></i>regex</a>
</footer><!-- /.post-info -->		</div>
		<p>前些日子读《精通正则表达式》读的起劲，每天早起读个把小时，兴趣盎然。</p>
<p>正愁没实战场景，只每天在Vim里用用，颇为寂寞。</p>
<p>前几天室友要处理一批类歌词文件（英文朗读？），需要清理其中的部分内容，手动操作很是繁琐，让我试着用代码帮着处理下。啊，这不正是使用正则的绝佳场所么</p>
<h1>待处理文本</h1>
<p>文本是这样的</p>
<div class="highlight"><pre><span></span>TPO_2102_L01

0   2.16    Listen to part of lecture in the history of science class.
2.16    11.2    OK, we&#39;ve been talking about how throughout the history.        好的,我们已经讨论过历史的发展.
11.2    14.8    It was often difficult for people to give up ideas which have long been taken for granted as scientific truths, even if those ideas were false.     人们放弃一种已经被认定是科学的事实的念头非常困难,即使那个念头是不对的.
14.8    24.32   In astronomy, for example, the distinction between the solar system and the universe wasn&#39;t clear until modern times.       拿天文学来举个例子,人们直到近代才将太阳系和宇宙的概念弄清楚. (第一题what&#39;s the purpose of the lecture?)
24.32   32.04   The ancient Greeks believed that what we called the solar system was in fact the entire universe, and that the universe was geocentric.     古希腊认为宇宙就是我们现在所说的太阳系,而整个宇宙中,地球就是宇宙的中心.
32.04   43.0    Geocentric means Earth-centric, so the geocentric view holds that the Sun, the planets, and the stars, all revolve around the Earth which is stationary.
43.0    54.72   Of course, we now know that the planets including Earth revolve around the Sun, and that solar system is only a tiny part of the universe.      当然了,我们现在是知道所有的星球都围绕着太阳转,地球也是星球,而且太阳系只是宇宙的一小部分.

......
</pre></div>


<h1>需求</h1>
<p>某路径下有若干txt文件,清理掉文件中的中文，夹杂在中文中数字/英文/标点也一并清除</p>
<h1>正则的视角</h1>
<p>在正则的视角下的解决方案，大约是这样的，对于每个文件，从每一行的第一个中文字符，一直清除到行尾 （以行为基本单位）</p>
<h1>解决方案（Python版）</h1>
<p>直接上代码啦，当当当当</p>
<div class="highlight"><pre><span></span><span class="ch">#!/usr/bin/env python3</span>
<span class="c1"># encoding: utf-8</span>

<span class="kn">import</span> <span class="nn">re</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">import</span> <span class="nn">os</span>

<span class="k">def</span> <span class="nf">filter_filetype</span><span class="p">(</span><span class="n">path</span><span class="p">,</span><span class="n">filetype</span><span class="p">):</span>
    <span class="n">filetype</span> <span class="o">=</span> <span class="n">filetype</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span>
    <span class="n">filenames</span> <span class="o">=</span> <span class="p">[</span><span class="n">filename</span> <span class="k">for</span> <span class="n">filename</span> <span class="ow">in</span> <span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isfile</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">filename</span><span class="p">))]</span> <span class="c1">#Get all regular files</span>
    <span class="n">filter_filename_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">filename</span> <span class="k">for</span> <span class="n">filename</span> <span class="ow">in</span> <span class="n">filenames</span> <span class="k">if</span> <span class="n">filename</span><span class="o">.</span><span class="n">endswith</span><span class="p">(</span><span class="n">filetype</span><span class="p">)]</span>
    <span class="k">return</span> <span class="n">filter_filename_list</span>

<span class="k">def</span> <span class="nf">clean_zh</span><span class="p">(</span><span class="n">filename</span><span class="p">):</span>
    <span class="n">zh_to_endline</span> <span class="o">=</span> <span class="n">re</span><span class="o">.</span><span class="n">compile</span><span class="p">(</span><span class="s2">r&quot;[\u4e00-\u9fa5].*&quot;</span><span class="p">,</span><span class="n">re</span><span class="o">.</span><span class="n">MULTILINE</span><span class="p">)</span> <span class="c1">#匹配从中文开始到行尾,多行模式</span>
    <span class="n">filename_split</span> <span class="o">=</span> <span class="n">filename</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">)</span>
    <span class="n">output_filename</span> <span class="o">=</span> <span class="n">filename_split</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="s2">&quot;_output.&quot;</span><span class="o">+</span><span class="n">filename_split</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">output_file</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="n">output_filename</span><span class="p">,</span><span class="s2">&quot;w&quot;</span><span class="p">)</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span><span class="s2">&quot;r+&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">input_file</span><span class="p">:</span>
            <span class="n">clean_content</span> <span class="o">=</span> <span class="n">zh_to_endline</span><span class="o">.</span><span class="n">sub</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">,</span><span class="n">input_file</span><span class="o">.</span><span class="n">read</span><span class="p">())</span>
            <span class="c1">#clean_line = zh_to_endline.sub(&quot;&quot;,line) #返回替换完的行，如果没有替换则原文返回</span>
            <span class="n">output_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">clean_content</span><span class="p">)</span>
            <span class="c1">#input_file.seek(0) #移到文件头，覆盖掉</span>
            <span class="c1">#input_file.write(clean_content)</span>
    <span class="n">output_file</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>


<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="n">path</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="c1">#传递命令行参数 path</span>
    <span class="n">filetype</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="c1">#传递命令行参数 filetype</span>
    <span class="n">filter_filename_list</span> <span class="o">=</span> <span class="n">filter_filetype</span><span class="p">(</span><span class="n">path</span><span class="p">,</span><span class="n">filetype</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">filename</span> <span class="ow">in</span> <span class="n">filter_filename_list</span><span class="p">:</span>
        <span class="n">clean_zh</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">path</span><span class="p">,</span><span class="n">filename</span><span class="p">))</span>
</pre></div>


<p>以上代码保存在clean_zh.py中</p>
<p>使用：<code>python3 clean_zh.py PATH txt</code> 。</p>
<p>使用python3运行，python2对unicode的支持不好</p>
<p>函数写的很不纯，之后重构一下</p>
<p>关于Python字符串的搜索和替换可以参考<a href="http://python3-cookbook.readthedocs.org/zh_CN/latest/c02/p05_search_and_replace_text.html">这里</a></p>
<h1>todo</h1>
<p>发现这是个很棒的Code Kata（通过实际的编程练习来提升敏捷开发的技能）<br />
于是决定写下其他语言的实现版本作为练习</p>
<p>涉及的知识点：</p>
<ul>
<li>正则表达式</li>
<li>字符串(unicode)</li>
<li>文件和目录</li>
<li>函数(参数)</li>
<li>命令行参数</li>
</ul>
<h3>Ruby</h3>
<div class="highlight"><pre><span></span><span class="ch">#!/usr/bin/env ruby</span>
<span class="c1">#encoding=UTF-8</span>

<span class="k">def</span> <span class="nf">filter_filetype</span><span class="p">(</span><span class="n">path</span><span class="p">,</span><span class="n">filetype</span><span class="p">)</span>
  <span class="n">filetype</span> <span class="o">=</span> <span class="n">filetype</span><span class="o">.</span><span class="n">downcase</span>
  <span class="n">filenames</span> <span class="o">=</span> <span class="no">Dir</span><span class="o">.</span><span class="n">entries</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
  <span class="n">filter_filename_list</span> <span class="o">=</span> <span class="n">filenames</span><span class="o">.</span><span class="n">select</span> <span class="p">{</span> <span class="o">|</span><span class="n">filename</span><span class="o">|</span> <span class="n">filename</span><span class="o">.</span><span class="n">end_with?filetype</span> <span class="p">}</span>
  <span class="k">return</span> <span class="n">filter_filename_list</span>
<span class="k">end</span>

<span class="k">def</span> <span class="nf">clean_zh</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
  <span class="n">zh_to_endline</span> <span class="o">=</span> <span class="sr">/[\u4e00-\u9fa5].*/</span> <span class="c1">#匹配从中文开始到行尾</span>
  <span class="c1">#clean_content = str.sub(zh_to_endline, &quot;&quot;)</span>
  <span class="n">filename_split</span> <span class="o">=</span> <span class="n">filename</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">)</span>
  <span class="n">output_filename</span> <span class="o">=</span> <span class="n">filename_split</span><span class="o">[</span><span class="mi">0</span><span class="o">]+</span><span class="s2">&quot;_output.&quot;</span><span class="o">+</span><span class="n">filename_split</span><span class="o">[</span><span class="mi">1</span><span class="o">]</span>
  <span class="no">File</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span> <span class="k">do</span> <span class="o">|</span><span class="n">file</span><span class="o">|</span>
    <span class="c1">#file.each_line{|line| puts line.sub(zh_to_endline,&quot;&quot;)}</span>
    <span class="n">contents</span> <span class="o">=</span>  <span class="n">file</span><span class="o">.</span><span class="n">read</span><span class="p">()</span>
    <span class="c1">#clean_content = contents.sub(zh_to_endline,&quot;&quot;)</span>
    <span class="n">clean_content</span> <span class="o">=</span> <span class="n">contents</span><span class="o">.</span><span class="n">gsub</span><span class="p">(</span><span class="n">zh_to_endline</span><span class="p">,</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
    <span class="n">output_filename</span> <span class="o">=</span> <span class="no">File</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="n">output_filename</span><span class="p">,</span><span class="s2">&quot;w&quot;</span><span class="p">)</span>
    <span class="n">output_filename</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">clean_content</span><span class="p">)</span>
    <span class="n">output_filename</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
    <span class="c1">#puts clean_content</span>
  <span class="k">end</span>
<span class="k">end</span>

<span class="k">if</span> <span class="bp">__FILE__</span> <span class="o">==</span> <span class="vg">$0</span>
  <span class="n">path</span> <span class="o">=</span> <span class="no">ARGV</span><span class="o">[</span><span class="mi">0</span><span class="o">]</span>
  <span class="n">filetype</span> <span class="o">=</span> <span class="no">ARGV</span><span class="o">[</span><span class="mi">1</span><span class="o">]</span>
  <span class="n">filter_filename_list</span> <span class="o">=</span> <span class="n">filter_filetype</span><span class="p">(</span><span class="n">path</span><span class="p">,</span><span class="n">filetype</span><span class="p">)</span>
  <span class="n">filter_filename_list</span><span class="o">.</span><span class="n">each</span> <span class="k">do</span> <span class="o">|</span><span class="n">filename</span><span class="o">|</span>
    <span class="n">clean_zh</span><span class="p">(</span><span class="no">File</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">path</span><span class="p">,</span><span class="n">filename</span><span class="p">))</span>
  <span class="k">end</span>
<span class="k">end</span>
</pre></div>


<p>使用 <code>ruby clean_zh.rb PATH txt</code></p>
<p>Ruby写起来似乎比Python还惬意~</p>
<h3>Golang</h3>
<div class="highlight"><pre><span></span><span class="n">package</span> <span class="n">main</span>

<span class="kn">import</span> <span class="p">(</span>
        <span class="s2">&quot;fmt&quot;</span>
        <span class="s2">&quot;io/ioutil&quot;</span>
        <span class="s2">&quot;os&quot;</span>
        <span class="o">//</span><span class="s2">&quot;path&quot;</span>
        <span class="s2">&quot;path/filepath&quot;</span>
        <span class="s2">&quot;regexp&quot;</span>
        <span class="s2">&quot;strings&quot;</span>
<span class="p">)</span>

<span class="n">func</span> <span class="n">clean_zh</span><span class="p">(</span><span class="n">filename</span> <span class="n">string</span><span class="p">)</span> <span class="nb">int</span> <span class="p">{</span>
        <span class="o">//</span><span class="n">pattern</span> <span class="p">:</span><span class="o">=</span> <span class="s2">&quot;(?i)[</span><span class="se">\u4e00</span><span class="s2">-</span><span class="se">\u9fa5</span><span class="s2">].*&quot;</span>
        <span class="n">pattern</span> <span class="p">:</span><span class="o">=</span> <span class="s2">&quot;(?i)[</span><span class="se">\u4e00</span><span class="s2">-</span><span class="se">\u9fa5</span><span class="s2">].*&quot;</span>
        <span class="n">reg</span> <span class="p">:</span><span class="o">=</span> <span class="n">regexp</span><span class="o">.</span><span class="n">MustCompile</span><span class="p">(</span><span class="n">pattern</span><span class="p">)</span>
        <span class="n">contents</span><span class="p">,</span> <span class="n">_</span> <span class="p">:</span><span class="o">=</span> <span class="n">ioutil</span><span class="o">.</span><span class="n">ReadFile</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
        <span class="n">clean_content</span> <span class="p">:</span><span class="o">=</span> <span class="n">reg</span><span class="o">.</span><span class="n">ReplaceAllString</span><span class="p">(</span><span class="n">string</span><span class="p">(</span><span class="n">contents</span><span class="p">),</span> <span class="s2">&quot;&quot;</span><span class="p">)</span>
        <span class="o">//</span><span class="n">println</span><span class="p">(</span><span class="n">string</span><span class="p">(</span><span class="n">contents</span><span class="p">))</span>
        <span class="o">//</span><span class="n">println</span><span class="p">(</span><span class="n">contents</span><span class="p">)</span>
        <span class="n">filename_split</span> <span class="p">:</span><span class="o">=</span> <span class="n">strings</span><span class="o">.</span><span class="n">Split</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="s2">&quot;.&quot;</span><span class="p">)</span>
        <span class="n">output_filename</span> <span class="p">:</span><span class="o">=</span> <span class="n">filename_split</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="s2">&quot;_output.&quot;</span> <span class="o">+</span> <span class="n">filename_split</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">fmt</span><span class="o">.</span><span class="n">Printf</span><span class="p">(</span><span class="n">output_filename</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">fmt</span><span class="o">.</span><span class="n">Printf</span><span class="p">(</span><span class="n">filename</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

        <span class="n">ioutil</span><span class="o">.</span><span class="n">WriteFile</span><span class="p">(</span><span class="n">output_filename</span><span class="p">,</span> <span class="p">[]</span><span class="n">byte</span><span class="p">(</span><span class="n">clean_content</span><span class="p">),</span> <span class="mo">0644</span><span class="p">)</span>
        <span class="k">return</span> <span class="mi">1</span>
<span class="p">}</span>

<span class="n">func</span> <span class="n">main</span><span class="p">()</span> <span class="p">{</span>
        <span class="n">getpath</span> <span class="p">:</span><span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">Args</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
        <span class="n">filetype</span> <span class="p">:</span><span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">Args</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span>
        <span class="n">files</span><span class="p">,</span> <span class="n">_</span> <span class="p">:</span><span class="o">=</span> <span class="n">filepath</span><span class="o">.</span><span class="n">Glob</span><span class="p">(</span><span class="n">getpath</span> <span class="o">+</span> <span class="s2">&quot;/*&quot;</span><span class="p">)</span> <span class="o">//</span> <span class="n">contains</span> <span class="n">a</span> <span class="nb">list</span> <span class="n">of</span> <span class="nb">all</span> <span class="n">files</span> <span class="ow">in</span> <span class="n">the</span> <span class="n">path</span>
        <span class="o">//</span><span class="n">fmt</span><span class="o">.</span><span class="n">Printf</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%s</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">files</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">_</span><span class="p">,</span> <span class="n">filename</span> <span class="p">:</span><span class="o">=</span> <span class="nb">range</span> <span class="n">files</span> <span class="p">{</span>
                <span class="o">//</span><span class="n">i</span><span class="err">是索引，</span><span class="n">c</span><span class="err">是值</span>
                <span class="n">filename_split</span> <span class="p">:</span><span class="o">=</span> <span class="n">strings</span><span class="o">.</span><span class="n">Split</span><span class="p">(</span><span class="n">filename</span><span class="p">,</span> <span class="s2">&quot;.&quot;</span><span class="p">)</span>
                <span class="k">if</span> <span class="n">filename_split</span><span class="p">[</span><span class="nb">len</span><span class="p">(</span><span class="n">filename_split</span><span class="p">)</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="n">filetype</span> <span class="p">{</span>
                        <span class="n">fmt</span><span class="o">.</span><span class="n">Printf</span><span class="p">(</span><span class="n">filename</span> <span class="o">+</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
                        <span class="n">clean_zh</span><span class="p">(</span><span class="n">filename</span><span class="p">)</span>
                <span class="p">}</span>

        <span class="p">}</span>
<span class="p">}</span>
</pre></div>


<p>使用 <code>go run clean_zh.go PATH txt</code></p>
<p>Golang的语法糖好少！想使用Slices来收集过滤完的filename</p>
<h3>Nodejs</h3>
<div class="highlight"><pre><span></span><span class="c1">//use =G to formet js with javascript.vim</span>
<span class="kd">var</span> <span class="nx">fs</span> <span class="o">=</span> <span class="nx">require</span><span class="p">(</span><span class="s1">&#39;fs&#39;</span><span class="p">);</span>

<span class="kd">function</span> <span class="nx">is_filetype</span><span class="p">(</span><span class="nx">element</span><span class="p">,</span> <span class="nx">index</span><span class="p">,</span> <span class="nx">array</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">if</span> <span class="p">(</span><span class="nx">element</span><span class="p">.</span><span class="nx">split</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">)[</span><span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="nx">filetype</span><span class="p">)</span> <span class="c1">// 使用全局变量？之后使用闭包替换吧</span>
        <span class="k">return</span> <span class="kc">true</span><span class="p">;</span>
    <span class="k">else</span>
        <span class="k">return</span> <span class="kc">false</span><span class="p">;</span>
<span class="p">}</span>

<span class="kd">function</span> <span class="nx">clean_zh</span><span class="p">(</span><span class="nx">filename</span><span class="p">){</span>
    <span class="nx">fs</span><span class="p">.</span><span class="nx">readFile</span><span class="p">(</span><span class="nx">filename</span><span class="p">,</span><span class="s1">&#39;utf-8&#39;</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">,</span> <span class="nx">data</span><span class="p">)</span> <span class="p">{</span>
        <span class="nx">filename_split</span> <span class="o">=</span> <span class="nx">filename</span><span class="p">.</span><span class="nx">split</span><span class="p">(</span><span class="s2">&quot;.&quot;</span><span class="p">);</span>
        <span class="nx">output_filename</span> <span class="o">=</span> <span class="nx">filename_split</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">+</span><span class="s2">&quot;_output.&quot;</span><span class="o">+</span><span class="nx">filename_split</span><span class="p">[</span><span class="mi">1</span><span class="p">];</span>
        <span class="k">if</span> <span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{</span>
            <span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="nx">err</span><span class="p">);</span>
        <span class="p">}</span> <span class="k">else</span> <span class="p">{</span>
            <span class="kd">var</span> <span class="nx">reg</span> <span class="o">=</span> <span class="sr">/[\u4e00-\u9fa5].*/g</span><span class="p">;</span>
            <span class="kd">var</span> <span class="nx">res</span> <span class="o">=</span> <span class="nx">data</span><span class="p">.</span><span class="nx">replace</span><span class="p">(</span><span class="nx">reg</span><span class="p">,</span> <span class="s1">&#39;&#39;</span><span class="p">);</span>
            <span class="nx">fs</span><span class="p">.</span><span class="nx">writeFile</span><span class="p">(</span><span class="nx">output_filename</span><span class="p">,</span><span class="nx">res</span><span class="p">,</span> <span class="kd">function</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span> <span class="p">{</span><span class="k">if</span><span class="p">(</span><span class="nx">err</span><span class="p">)</span><span class="nx">console</span><span class="p">.</span><span class="nx">error</span><span class="p">(</span><span class="nx">err</span><span class="p">);});</span>
        <span class="p">}</span>
    <span class="p">});</span>
<span class="p">}</span>

<span class="kd">var</span> <span class="nx">path</span> <span class="o">=</span> <span class="nx">process</span><span class="p">.</span><span class="nx">argv</span><span class="p">[</span><span class="mi">2</span><span class="p">];</span>
<span class="kd">var</span> <span class="nx">filetype</span> <span class="o">=</span> <span class="nx">process</span><span class="p">.</span><span class="nx">argv</span><span class="p">[</span><span class="mi">3</span><span class="p">];</span>
<span class="kd">var</span> <span class="nx">filenames</span> <span class="o">=</span> <span class="nx">fs</span><span class="p">.</span><span class="nx">readdirSync</span><span class="p">(</span><span class="nx">path</span><span class="p">);</span> <span class="c1">//等待io的返回，需要使用同步方法</span>
<span class="kd">var</span> <span class="nx">filter_filenames</span> <span class="o">=</span> <span class="nx">filenames</span><span class="p">.</span><span class="nx">filter</span><span class="p">(</span><span class="nx">is_filetype</span><span class="p">);</span>
<span class="nx">filter_filenames</span><span class="p">.</span><span class="nx">map</span><span class="p">(</span><span class="nx">clean_zh</span><span class="p">);</span>
</pre></div>


<p>使用：<code>node clean_zh.js PATH txt</code></p>
<p>js注意回调。回调之外想要控制顺序的话，用同步函数吧</p>
<h3>Coffeescript</h3>
<p>waiting</p>
<h3>Bash</h3>
<div class="highlight"><pre><span></span><span class="ch">#!/bin/bash</span>

<span class="c1">#cd /tmp  使之成为当前工作目录</span>

<span class="nv">path</span><span class="o">=</span><span class="nv">$1</span> <span class="c1">#不能有空格 </span>
<span class="nv">filetype</span><span class="o">=</span><span class="nv">$2</span>
<span class="nb">cd</span> <span class="nv">$path</span>
<span class="nv">filenames</span><span class="o">=</span><span class="sb">`</span>ls<span class="sb">`</span>
<span class="c1">#echo $filenames</span>
<span class="k">for</span> filename in <span class="nv">$filenames</span>
<span class="k">do</span>
    <span class="k">if</span> <span class="o">[[</span> <span class="se">\&quot;</span><span class="nv">$filename</span><span class="se">\&quot;</span> <span class="o">=</span>~ .*txt <span class="o">]]</span><span class="p">;</span><span class="k">then</span> <span class="c1">#注意空格</span>
        <span class="c1">#如何把$filename变为字符串</span>
        <span class="nb">echo</span> <span class="s2">&quot;import re;zh_to_endline = re.compile(r\&quot;[\u4e00-\u9fa5].*\&quot;);file = open(\&quot;</span><span class="nv">$filename</span><span class="s2">\&quot;);clean_content = zh_to_endline.sub(\&quot;\&quot;,file.read());print(clean_content);&quot;</span> <span class="p">|</span> python3 &gt;&gt; <span class="s2">&quot;output_</span><span class="nv">$filename</span><span class="s2">&quot;</span>
        <span class="c1">#echo $filename</span>
    <span class="k">fi</span>

<span class="k">done</span>
</pre></div>


<p>使用<code>sh clean_zh PATH txt</code></p>
<p>原先想用sed的，发现它好像根本不支持unicode？？耍赖把文本处理的工作丢给Python了。</p>
<p>bash真是dirty and quick</p>
<h3>Scheme</h3>
<h3>Haskell</h3>
<h3>Prolog</h3>
<h3>Lua</h3>
<h3>Clojure</h3>
<h3>Scala</h3>
<h3>Perl</h3>
<h3>Racket</h3>
<h3>C<code>#</code></h3>
<h3>C</h3>
<h3>Java</h3>
<h3>PHP</h3>
		</div><!-- /.entry-content -->
<!--
<p style="font-size:16px" class="alert alert-info">此文对我有价值，打赏杯茶喝^_^  <a target="_blank" class="btn btn-primary btn-large" href="https://me.alipay.com/wuwj">支付宝打赏</a> </p>
-->
<hr>
<div class="alert alert-success">版权声明：<a href="http://creativecommons.org/licenses/by-nc-nd/3.0/deed.zh">自由转载-非商用-非衍生-保持署名</a></div>
<hr>
<!-- Duoshuo Comment BEGIN -->
<!--
	<div class="ds-thread"></div>
<script type="text/javascript">
var duoshuoQuery = {short_name:"wwj718blog"};
	(function() {
		var ds = document.createElement('script');
		ds.type = 'text/javascript';ds.async = true;
		ds.src = 'http://static.duoshuo.com/embed.js';
		ds.charset = 'UTF-8';
		(document.getElementsByTagName('head')[0] 
		|| document.getElementsByTagName('body')[0]).appendChild(ds);
	})();
	</script>
    -->
    <!-- Duoshuo Comment END -->
	</article>
</section>
        </div><!--/span-->
      
		<div style="margin-left:70px;" class="span3 well sidebar-nav" id="sidebar">
<ul class="nav nav-list">
    <!--<a href="/others/startedx.html"><h3>Open edX相关咨询</h3></a>-->
<hr/>
<!--
<h3>我的服务<h3>
    <a href="http://olk8jbdzi.bkt.clouddn.com/index.html"><h4>开源在线表单设计工具</h4></a>
    <a href="#kinto.jsut4fun.site"><h4>kinto server(施工中)</h4></a>
    <a href="#"><h4></h4></a>
-->
<!--<a href="/join-us"><h3>招兵买马(招实习!)<h3></a>-->
</hr>
</hr>

<a style="text-align: center;" href="https://www.e-ducation.cn/?utm_source=zgblog&utm_medium=ads&utm_campaign=marketing_01"><img src="http://os54tv4fc.bkt.clouddn.com/education.png" width="150px" /> </a>
<hr/>

<h4>站内搜索(基于google，你可能看不到)</h4>
<div>
<script>
  (function() {
       var cx = '004056624884628766270:aaifcpik-ua';
	       var gcse = document.createElement('script');
		       gcse.type = 'text/javascript';
			       gcse.async = true;
				       gcse.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') +
					           '//www.google.com/cse/cse.js?cx=' + cx;
							       var s = document.getElementsByTagName('script')[0];
								       s.parentNode.insertBefore(gcse, s);
									     })();
</script>
<gcse:search></gcse:search>
</div>
<hr>
<h4>手机访问：</h4>

<img style="text-align: center;" src="http://os54tv4fc.bkt.clouddn.com/1514204585.png" width="150px" /> 

    <li><i class="icon-external-link"></i><a href="/aboutme.html">关于我</a></li>
    <li><i class="icon-external-link"></i><a href="https://github.com/wwj718">my github</a></li>
    <li><i class="icon-external-link"></i><a href="#">my gmail：wuwenjie718@gmail.com</a></li>
<hr>

<li class="nav-header"><h4><i class="icon-folder-close icon-large"></i>分类</h4></li>
<li>
<a href="/category/编程.html">
    <i class="icon-folder-open icon-large"></i>编程
</a>
</li>
<li>
<a href="/category/读书.html">
    <i class="icon-folder-open icon-large"></i>读书
</a>
</li>
<li>
<a href="/category/edx.html">
    <i class="icon-folder-open icon-large"></i>edx
</a>
</li>
<li>
<a href="/category/工具.html">
    <i class="icon-folder-open icon-large"></i>工具
</a>
</li>
<li>
<a href="/category/观念.html">
    <i class="icon-folder-open icon-large"></i>观念
</a>
</li>
<li>
<a href="/category/技术.html">
    <i class="icon-folder-open icon-large"></i>技术
</a>
</li>
<li>
<a href="/category/架构.html">
    <i class="icon-folder-open icon-large"></i>架构
</a>
</li>
<li>
<a href="/category/空想.html">
    <i class="icon-folder-open icon-large"></i>空想
</a>
</li>
<li>
<a href="/category/诗词.html">
    <i class="icon-folder-open icon-large"></i>诗词
</a>
</li>
<li>
<a href="/category/数据.html">
    <i class="icon-folder-open icon-large"></i>数据
</a>
</li>
<li>
<a href="/category/算法.html">
    <i class="icon-folder-open icon-large"></i>算法
</a>
</li>
<li>
<a href="/category/随笔.html">
    <i class="icon-folder-open icon-large"></i>随笔
</a>
</li>
<li>
<a href="/category/瓦碎集.html">
    <i class="icon-folder-open icon-large"></i>瓦碎集
</a>
</li>
<li>
<a href="/category/硬件.html">
    <i class="icon-folder-open icon-large"></i>硬件
</a>
</li>

<li class="nav-header"><h4><i class="icon-tags icon-large"></i>Tags</h4></li>
<hr>

<a target="_blank" href="http://wwj718.github.io/feeds/all.rss.xml">订阅feed</a>

</ul>        </div><!--/.well -->

      </div><!--/row-->

      <hr>

      <footer id="footer">
        <address id="about">
            被误解是表达者的宿命<hr>
              powered by Pelican 
<script type="text/javascript">
var _bdhmProtocol = (("https:" == document.location.protocol) ? " https://" : " http://");
document.write(unescape("%3Cscript src='" + _bdhmProtocol + "hm.baidu.com/h.js%3F18db4b662c04fbd6cc2851d246c51b3f' type='text/javascript'%3E%3C/script%3E"));
</script>        </address><!-- /#about -->
      </footer>

    </div><!--/.fluid-container-->
<a href="https://github.com/wwj718"><img style="position: absolute; top: 0; left: 0; border: 0;" src="https://camo.githubusercontent.com/567c3a48d796e2fc06ea80409cc9dd82bf714434/68747470733a2f2f73332e616d617a6f6e6177732e636f6d2f6769746875622f726962626f6e732f666f726b6d655f6c6566745f6461726b626c75655f3132313632312e706e67" alt="Fork me on GitHub" data-canonical-src="https://s3.amazonaws.com/github/ribbons/forkme_left_darkblue_121621.png"></a>

    <!-- Le javascript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script src="http://libs.baidu.com/jquery/1.8.2/jquery.min.js"></script>
    <script src="/theme/js/bootstrap-transition.js"></script>
    <script src="/theme/js/bootstrap-dropdown.js"></script>
    <script src="/theme/js/bootstrap-collapse.js"></script>
	
	<!--<script src="/theme/js/autosidebar.js"></script>-->
  </body>
</html>
