<!--

 -----------------
< 终于等到你 >
 -----------------
        \   ^__^
         \  (oo)\_______
            (__)\       )\/\
                ||----w |
                ||     ||
----------------------------------

我正在构建一个基于网络协作的虚拟团队
喜欢你这种没事瞎翻源码的人
如果你恰好也热爱技术、喜欢折腾，一起来捣鼓好玩的东西吧
联系我咯: wuwenjie718@gmail.com
-->
<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>blocks for open edx</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="writing for time">
    <meta name="author" content="wwj">

    <!-- Le styles -->
    <link href="//cdn.bootcss.com/twitter-bootstrap/2.0.4/css/bootstrap.min.css" rel="stylesheet">
    <link rel="icon" href="//7kttuq.com1.z0.glb.clouddn.com/just4fun.png?imageView2/2/w/50" type="image/x-icon">
    <style type="text/css">
      body {
        padding-top: 60px;
        padding-bottom: 40px;
      }
      .sidebar-nav {
        padding: 9px 0;
      }
	
	.tag-1 {
		font-size: 13pt;
	}
	
	.tag-2 {
		font-size: 10pt;
	}
	
	.tag-2 {
		font-size: 8pt;
	}

	.tag-4 {
		font-size: 6pt;
	}

  #footer img{
    visibility: hidden;
  }
	
    </style>
    <link href="//cdn.bootcss.com/twitter-bootstrap/2.0.4/css/bootstrap-responsive.min.css" rel="stylesheet">
    <link href="//cdn.bootcss.com/font-awesome/3.0.0/css/font-awesome.min.css" rel="stylesheet">
	
    <link href="/theme/css/pygments.css" rel="stylesheet">
	<link href="/theme/css/mystyle.css" rel="stylesheet">
    <!-- Le HTML5 shim, for IE6-8 support of HTML5 elements -->
    <!--[if lt IE 9]>
      <script src="//html5shim.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link rel="shortcut icon" href="http://wwj-tmp-video.just4fun.site/favicon.ico">
    <!-- Le fav and touch icons -->


  </head>

  <body>

    <div class="navbar navbar-fixed-top">
      <div class="navbar-inner">
        <div class="container-fluid">
          <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </a>
          <a class="brand" href="/index.html">writing for time </a>
          <div class="nav-collapse">
            <ul class="nav">
			  <li class="divider-vertical"></li>
                  <li >
                    <a href="/category/编程.html">
						<i class="icon-folder-open icon-large"></i>编程
					</a>
                  </li>
                  <li >
                    <a href="/category/读书.html">
						<i class="icon-folder-open icon-large"></i>读书
					</a>
                  </li>
                  <li class="active">
                    <a href="/category/edx.html">
						<i class="icon-folder-open icon-large"></i>edx
					</a>
                  </li>
                  <li >
                    <a href="/category/工具.html">
						<i class="icon-folder-open icon-large"></i>工具
					</a>
                  </li>
                  <li >
                    <a href="/category/观念.html">
						<i class="icon-folder-open icon-large"></i>观念
					</a>
                  </li>
                  <li >
                    <a href="/category/技术.html">
						<i class="icon-folder-open icon-large"></i>技术
					</a>
                  </li>
                  <li >
                    <a href="/category/架构.html">
						<i class="icon-folder-open icon-large"></i>架构
					</a>
                  </li>
                  <li >
                    <a href="/category/空想.html">
						<i class="icon-folder-open icon-large"></i>空想
					</a>
                  </li>
                  <li >
                    <a href="/category/少儿编程.html">
						<i class="icon-folder-open icon-large"></i>少儿编程
					</a>
                  </li>
                  <li >
                    <a href="/category/诗词.html">
						<i class="icon-folder-open icon-large"></i>诗词
					</a>
                  </li>
                  <li >
                    <a href="/category/数据.html">
						<i class="icon-folder-open icon-large"></i>数据
					</a>
                  </li>
                  <li >
                    <a href="/category/算法.html">
						<i class="icon-folder-open icon-large"></i>算法
					</a>
                  </li>
                  <li >
                    <a href="/category/随笔.html">
						<i class="icon-folder-open icon-large"></i>随笔
					</a>
                  </li>
                  <li >
                    <a href="/category/瓦碎集.html">
						<i class="icon-folder-open icon-large"></i>瓦碎集
					</a>
                  </li>
                  <li >
                    <a href="/category/硬件.html">
						<i class="icon-folder-open icon-large"></i>硬件
					</a>
                  </li>
			  
			  <ul class="nav pull-right">
				<li><a href="/archives.html"><i class="icon-th-list"></i>Archives</a></li>
			  </ul>
			  
            </ul>
            <!--<p class="navbar-text pull-right">Logged in as <a href="#">username</a></p>-->
          </div><!--/.nav-collapse -->
        </div>
      </div>
    </div>





    <div class="container-fluid">
      <div class="row">

        <div class="span8 offset1" id="content">
            <!--<div class="alert alert-success" style="font-size:18px;">>  你那里天气好吗，有什么新闻可以当做笑话</div>-->
<section id="content">    
	<article>
		<header>
			<h1>
				<a href=""
					rel="bookmark" 
					title="Permalink to blocks for open edx">
					blocks for open edx 
				</a>
			</h1> 
		</header>
		<div class="entry-content">
		<div class="well">
<footer class="post-info">
<span class="label">Date</span>
<abbr class="published" title="2018-12-28T00:00:00+00:00">
	<i class="icon-calendar"></i>五 28 十二月 2018
</abbr>
<span class="label">By</span>
<a href="/author/wuwenjie.html"><i class="icon-user"></i>wuwenjie</a>
<span class="label">Category</span>
<a href="/category/edx.html"><i class="icon-folder-open"></i>edx</a>. 

	
<span class="label">Tags</span> 
	<a href="/tag/edx.html"><i class="icon-tag"></i>edx</a>
</footer><!-- /.post-info -->		</div>
		<p><img alt="" src="http://wwj-fig-bed.just4fun.site/blocks4edx_013bd76c.png" /></p>
<p><a href="https://open.edx.org/">Open edX</a>是我一直关心的开源项目。</p>
<p>近期参与构建了一个开源项目<a href="https://github.com/openEduClub/blocks4edx">blocks4edx</a>。在这个项目中，我们试着将积木引入Open edX中，帮助课程团队创作复杂的题目。blocks4edx可用于替代Open edX的<a href="https://edx.readthedocs.io/projects/edx-partner-course-staff/en/latest/exercises_tools/custom_python.html#write-your-own-grader-problem">Custom Python-Evaluated Input题目编辑器</a>。允许课程团队在不写代码的情况下，通过拖拽积木自动生成代码与题目(XML)。</p>
<p><a href="https://open.edx.org/blog/spotlight-elite-education">Elite Education</a>邀请我与@MT(曾老师)和他们一同参加2019.3.26在UCSD(加州大学圣地亚哥分校)举办的<a href="https://open.edx.org/blog/announcing-open-edx-2019-conference-hosted-uc-san-diego">Open edX年会</a>，在年会上，我们可能会就<a href="https://github.com/openEduClub/blocks4edx">blocks4edx</a>做一个主题演讲。</p>
<h1 id="_1">体验</h1>
<p>你可以通过<a href="https://e-ducation.github.io/blocks4edx/">这个链接</a>体验<a href="https://github.com/openEduClub/blocks4edx">blocks4edx</a>。</p>
<p>我在项目主页里写了<a href="https://github.com/openEduClub/blocks4edx">使用说明</a>.</p>
<h1 id="_2">缘起</h1>
<p>与@李懿的一次交流中，我们聊到 积木如此强大，它可以将领域概念封装在图形之下，暴露出合适粒度的积木块，而将其他细节屏蔽掉，用户通过组合积木来操控领域概念和表达逻辑。如此一来，就可以为不同细分领域的人，针对他们的问题，构建出问题域内合适粒度的积木供他们使用。</p>
<p>@李懿 想到课程团队在使用<a href="https://open.edx.org/">Open edX</a>时遇到的困难: 课程团队根据教授的课程和课件，经常需要制作<code>随机题目</code>，所谓的随机题目是指，题干的内容是随机的，但考察的知识点是确定的。举个例子，如果我们想考察两位数的加法，我们希望题干出现的数字是随机的，答案却会根据题目出现的数字做相应调整。于是我们就能做到了，既考察知识，又做到了题目随机化。</p>
<p><a href="https://open.edx.org/">Open edX</a>默认支持这种题型:<a href="https://edx.readthedocs.io/projects/edx-partner-course-staff/en/latest/exercises_tools/custom_python.html#write-your-own-grader-problem">Write-Your-Own-Grader Problem</a>，这是<a href="https://open.edx.org/">Open edX</a>令人震惊的地方，它对教育的思考非常深入。</p>
<p>目前官方给出<code>考察两位数的加法</code>的随机<a href="https://edx.readthedocs.io/projects/edx-partner-course-staff/en/latest/exercises_tools/custom_python.html#create-a-randomized-custom-python-evaluated-input-problem">题目模版</a>是:</p>
<div class="highlight"><pre><span></span><span class="nt">&lt;problem&gt;</span>
  <span class="nt">&lt;p&gt;</span>Some problems in the course will utilize randomized parameters.
     For such problems, after you check your answer you will have the option
     of resetting the question, which reconstructs the problem with a new
     set of parameters.<span class="nt">&lt;/p&gt;</span>
<span class="nt">&lt;script</span> <span class="na">type=</span><span class="s">&quot;loncapa/python&quot;</span><span class="nt">&gt;</span>
x1 = random.randint(0, 100)
x2 = random.randint(0, 100)
y = x1+x2
<span class="nt">&lt;/script&gt;</span>
<span class="nt">&lt;p&gt;</span>Let (x_1 = $x1) and (x_2 = $x2). What is the value of (x_1+x_2)?<span class="nt">&lt;/p&gt;</span>
<span class="nt">&lt;numericalresponse</span> <span class="na">answer=</span><span class="s">&quot;$y&quot;</span><span class="nt">&gt;</span>
  <span class="nt">&lt;responseparam</span> <span class="na">type=</span><span class="s">&quot;tolerance&quot;</span> <span class="na">default=</span><span class="s">&quot;0.01%&quot;</span> <span class="na">name=</span><span class="s">&quot;tol&quot;</span>
    <span class="na">description=</span><span class="s">&quot;Numerical Tolerance&quot;</span><span class="nt">/&gt;</span>
  <span class="nt">&lt;textline</span> <span class="na">size=</span><span class="s">&quot;10&quot;</span><span class="nt">/&gt;</span>
<span class="nt">&lt;/numericalresponse&gt;</span>
<span class="nt">&lt;solution&gt;</span>
  <span class="nt">&lt;p&gt;&lt;b&gt;</span>Explanation:<span class="nt">&lt;/b&gt;&lt;/p&gt;</span>
<span class="nt">&lt;/solution&gt;</span>
<span class="nt">&lt;/problem&gt;</span>
</pre></div>


<p>既有Python代码，又有XML代码。</p>
<p>@李懿指出美中不足的是，Open edX提供的随机题目编辑器需要编程才能实现(使用Python)。如此一来，每道题都需要课程团队与技术团队的配合。课程团队确定了考察的知识点后(往往是计算公式)，由技术人员用代码实现它。这不仅支出了技术人员的时间，也影响课程团队的进度，而且还增加考虑沟通成本。</p>
<p>能否让用积木来创建随机题目？</p>
<p>我们拉来课程团队的@李婷同学帮我们梳理了一遍创建随机题目的流程，并就着一道具体的题目，走完了整个流程。</p>
<p><img src="http://wwj-fig-bed.just4fun.site/edxblockly_b50cc7bb.png" width=600 /></p>
<p>接下来我们就用积木来优化这个流程，让课程团队可以通过拖拽积木，独立地实现题目的构建，而无需技术人员参与。<a href="https://github.com/openEduClub/blocks4edx">blocks4edx</a>将自动生成题目所需的所有代码: Python+XML。</p>
<h1 id="_3">技术方案</h1>
<p>我们选择<a href="https://github.com/google/blockly">blockly</a>作为基础工具。</p>
<p>第一步工作是将问题域中的概念积木化， 问题域中的所有概念都在官方文档中: <a href="https://edx.readthedocs.io/projects/edx-partner-course-staff/en/latest/exercises_tools/custom_python.html#write-your-own-grader-problem">Write-Your-Own-Grader Problem</a>。由此可见这是一道定义清晰地好问题，解决它的过程充满乐趣。</p>
<p>我们一直坚持积木是一项很有潜力的技术，<a href="https://codelab.club">codelab.club</a>将在这个问题上持续深挖，我们会探索积木的各种可能性。我们并不满足于copy一个国外项目，照着实现一遍，接着号称自主研发，就此了事。我们希望探索一些有趣的范式和最佳实践。</p>
<p>目前积木一般以两种方式被使用：</p>
<ul>
<li>其一是blockly官方例子中的方式，直接generate出代码。</li>
<li>其二是code.org/scratch3.0使用它的方式，将积木映射为js函数。</li>
</ul>
<p>我最初想用第一种方式，直接generate出Python代码。在这个想法里，积木编辑器被视为Python代码生成器，课程团队使用它来构建题目中Python代码相关的部分。积木编辑器不关心题目的其他部分（XML）。</p>
<p>后来我觉得，应该整体解决这个问题，课程团队不只是对Python代码不熟悉，他们构成题干的XML也不熟悉，仅生成Python代码是不够的。即便熟悉XML，手写XML也不是什么令人愉快的体验。于是我想一次生成所有的东西。</p>
<p>接着带着这个想法开始构建<a href="https://github.com/openEduClub/blocks4edx">blocks4edx</a>。</p>
<p>由于我想要的比较多，遇到的困难也就多些。既要生成Python代码，又要生成XML代码，blockly本身并不支持这种操作。于是我想到模版的思路，将XML视为文本，虽然它也以Python的方式generate出来，但本质上被看作文本，于是生成它地javascript有了预处理它的能力。如此一来，问题域里的XML结构肯定可以被积木化。</p>
<p>在这个思路下，只剩下一个困难需要解决： Python的import相关部分会被默认前置(如<code>import random</code>)，但它本不应该跑到所处的xml结构之外。由于xml以Python代码的方式generate，所以前置不可避免，但我们不能接受这点，怎么办呢？hack blockly的成本太高，不可接受。剩下的方案只有打破xml，依然是预处理地思路，这块的最终方案见源码细节:<a href="https://github.com/e-ducation/blocks4edx/blob/master/index.html#L257">var code = <code>&lt;problem&gt;\n&lt;script type="loncapa/python"&gt;\n${origin_code}</code>;</a></p>
<p>这个策略本质依然是把代码看作文本。如果你将代码视为字符串，你就拥有无限的力量，这是<a href="https://zh.wikipedia.org/zh-cn/LISP">LISP</a>教会我们的，但这种力量也很危险。这是一把力大无比却容易砸伤脚的锤子。</p>
<h1 id="todo">todo</h1>
<p>blocks4edx不只适用于<code>Custom Python-Evaluated Input</code>题目，也适用于edx的其他题目，因为edx中地大多题目都是XML，这意味着他们是文本！</p>
<p>积木可以生成文本，理论上我们就可以做任何事。</p>
<p>关于积木化其他题目，我们将在之后继续探索。</p>
<p>blocks4edx的目标是为课程团队提供更好的题目编辑器。</p>
<h1 id="_4">参考</h1>
<ul>
<li><a href="https://edx.readthedocs.io/projects/edx-partner-course-staff/en/latest/exercises_tools/custom_python.html#write-your-own-grader-problem">Write-Your-Own-Grader Problem</a></li>
<li><a href="https://github.com/google/blockly">blockly</a></li>
<li><a href="https://developers.google.com/blockly/guides/get-started/web#importing_and_exporting_blocks">importing and exporting blocks</a></li>
<li><a href="https://github.com/wwj718/blockly_dev">blockly_dev</a></li>
</ul>
		</div><!-- /.entry-content -->
<!--
<p style="font-size:16px" class="alert alert-info">此文对我有价值，打赏杯茶喝^_^  <a target="_blank" class="btn btn-primary btn-large" href="https://me.alipay.com/wuwj">支付宝打赏</a> </p>
-->
<hr>
<div class="alert alert-success">版权声明：<a href="http://creativecommons.org/licenses/by-nc-nd/3.0/deed.zh">自由转载-非商用-非衍生-保持署名</a></div>
<hr>
<!-- Duoshuo Comment BEGIN -->
<!--
	<div class="ds-thread"></div>
<script type="text/javascript">
var duoshuoQuery = {short_name:"wwj718blog"};
	(function() {
		var ds = document.createElement('script');
		ds.type = 'text/javascript';ds.async = true;
		ds.src = 'http://static.duoshuo.com/embed.js';
		ds.charset = 'UTF-8';
		(document.getElementsByTagName('head')[0] 
		|| document.getElementsByTagName('body')[0]).appendChild(ds);
	})();
	</script>
    -->
    <!-- Duoshuo Comment END -->
	</article>
</section>
        </div><!--/span-->
      
		<div style="margin-left:70px;" class="span3 well sidebar-nav" id="sidebar">
<ul class="nav nav-list">
    <!--<a href="/others/startedx.html"><h3>Open edX相关咨询</h3></a>-->
<hr/>
<!--
<h3>我的服务<h3>
    <a href="http://olk8jbdzi.bkt.clouddn.com/index.html"><h4>开源在线表单设计工具</h4></a>
    <a href="#kinto.jsut4fun.site"><h4>kinto server(施工中)</h4></a>
    <a href="#"><h4></h4></a>
-->
<!--<a href="/join-us"><h3>招兵买马(招实习!)<h3></a>-->
</hr>
</hr>

<li style="text-align: center;"><a target="_blank"  href="https://www.e-ducation.cn/?utm_source=zgblog&utm_medium=ads&utm_campaign=marketing_01"><img src="http://wwj-tmp-video.just4fun.site/education.png" width="100%" max-width="250px" /> </a></li>
<hr/>

<h4>我近期在折腾</h4>
<li><a href="https://blog.just4fun.site/about-codelab-club.html" target="_blank">codelab.club</a></li>
<li><a href="https://codelab-adapter-docs.codelab.club/" target="_blank">codelab-adapter</a></li>
<hr/>

<h4>少儿编程指北</h4>
<p>关注少儿编程，回顾这个领域的发展历程，推荐、解读经典书籍和文章，吐槽糟糕的教育，也推荐一些好产品和有趣的项目。不蹭热点不站队 :）</p>
<li style="text-align: center;">
<img src="http://scratch3-files.just4fun.site/qrcode_for_gh_e458d8658f3b_258.jpg" width="150px" /> 
</li>
<hr/>

<h4>站内搜索(基于google，你可能看不到)</h4>
<div>
<script>
  (function() {
       var cx = '004056624884628766270:aaifcpik-ua';
	       var gcse = document.createElement('script');
		       gcse.type = 'text/javascript';
			       gcse.async = true;
				       gcse.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') +
					           '//www.google.com/cse/cse.js?cx=' + cx;
							       var s = document.getElementsByTagName('script')[0];
								       s.parentNode.insertBefore(gcse, s);
									     })();
</script>
<gcse:search></gcse:search>
</div>
<hr>
<h4>手机访问：</h4>
<li style="text-align: center;">
<img src="http://wwj-tmp-video.just4fun.site/1514204585.png" width="150px" /> 
</li>

    <li><i class="icon-external-link"></i><a href="/aboutme.html">关于我</a></li>
    <li><i class="icon-external-link"></i><a href="https://github.com/wwj718">my github</a></li>
    <li><i class="icon-external-link"></i><a href="#">my gmail：wuwenjie718@gmail.com</a></li>
<hr>

<li class="nav-header"><h4><i class="icon-folder-close icon-large"></i>分类</h4></li>
<li>
<a href="/category/编程.html">
    <i class="icon-folder-open icon-large"></i>编程
</a>
</li>
<li>
<a href="/category/读书.html">
    <i class="icon-folder-open icon-large"></i>读书
</a>
</li>
<li>
<a href="/category/edx.html">
    <i class="icon-folder-open icon-large"></i>edx
</a>
</li>
<li>
<a href="/category/工具.html">
    <i class="icon-folder-open icon-large"></i>工具
</a>
</li>
<li>
<a href="/category/观念.html">
    <i class="icon-folder-open icon-large"></i>观念
</a>
</li>
<li>
<a href="/category/技术.html">
    <i class="icon-folder-open icon-large"></i>技术
</a>
</li>
<li>
<a href="/category/架构.html">
    <i class="icon-folder-open icon-large"></i>架构
</a>
</li>
<li>
<a href="/category/空想.html">
    <i class="icon-folder-open icon-large"></i>空想
</a>
</li>
<li>
<a href="/category/少儿编程.html">
    <i class="icon-folder-open icon-large"></i>少儿编程
</a>
</li>
<li>
<a href="/category/诗词.html">
    <i class="icon-folder-open icon-large"></i>诗词
</a>
</li>
<li>
<a href="/category/数据.html">
    <i class="icon-folder-open icon-large"></i>数据
</a>
</li>
<li>
<a href="/category/算法.html">
    <i class="icon-folder-open icon-large"></i>算法
</a>
</li>
<li>
<a href="/category/随笔.html">
    <i class="icon-folder-open icon-large"></i>随笔
</a>
</li>
<li>
<a href="/category/瓦碎集.html">
    <i class="icon-folder-open icon-large"></i>瓦碎集
</a>
</li>
<li>
<a href="/category/硬件.html">
    <i class="icon-folder-open icon-large"></i>硬件
</a>
</li>

<li class="nav-header"><h4><i class="icon-tags icon-large"></i>Tags</h4></li>
<hr>

<a target="_blank" href="http://wwj718.github.io/feeds/all.rss.xml">订阅feed</a>


<hr>
<h3>友情链接</h3>
<li><a target="_blank"  href="https://scratch.mit.edu/">Scratch</a></li>
<li><a target="_blank"  href="https://www.raspberrypi.org/">Raspberry Pi</a></li>
<li><a target="_blank" href="http://microbit.org/">micro:bit</a></li>
<li><a target="_blank" href="https://code.org/">Code.org</a></li>
<li><a target="_blank" href="https://www.edustack.org/">edustack</a></li>
<li><a target="_blank" href="http://blog.e-ducation.cn/">e-ducation</a></li>

</ul>        </div><!--/.well -->

      </div><!--/row-->

      <hr>

      <footer id="footer">
        <address id="about">
            诗酒趁年华<hr>
              powered by Pelican 
              <hr>
              <a href="www.miitbeian.gov.cn" target="_blank">苏ICP备18043473号</a>
<script type="text/javascript">
var _bdhmProtocol = (("https:" == document.location.protocol) ? " https://" : " http://");
document.write(unescape("%3Cscript src='" + _bdhmProtocol + "hm.baidu.com/h.js%3F18db4b662c04fbd6cc2851d246c51b3f' type='text/javascript'%3E%3C/script%3E"));
</script>        </address><!-- /#about -->
      </footer>

    </div><!--/.fluid-container-->
<a href="https://github.com/wwj718"><img style="position: absolute; top: 0; left: 0; border: 0;" src="https://camo.githubusercontent.com/567c3a48d796e2fc06ea80409cc9dd82bf714434/68747470733a2f2f73332e616d617a6f6e6177732e636f6d2f6769746875622f726962626f6e732f666f726b6d655f6c6566745f6461726b626c75655f3132313632312e706e67" alt="Fork me on GitHub" data-canonical-src="https://s3.amazonaws.com/github/ribbons/forkme_left_darkblue_121621.png"></a>

    <!-- Le javascript
    ================================================== -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script src="http://libs.baidu.com/jquery/1.8.2/jquery.min.js"></script>
    <script src="/theme/js/bootstrap-transition.js"></script>
    <script src="/theme/js/bootstrap-dropdown.js"></script>
    <script src="/theme/js/bootstrap-collapse.js"></script>
	
	<!--<script src="/theme/js/autosidebar.js"></script>-->
  </body>
</html>
